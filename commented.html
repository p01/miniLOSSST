<body onload='

// LOSSST 1kb demake
// =================

// Move the snake using arrow keys, reset with R, skip with space.
// Match the white pattern to solve each puzzle.
// Puzzles 18+ use wrapping (to show it, the puzzle gets a black background)

// The scene is made of 20x10 squares, counted with `p` (0 to 200).
// Current puzzle number (0-40?) is stored in `l`.
// Snake squares coordinates are stored in `s` (s[0] is the head, etc).
// Snake length depends on the levels (8,11,13,14,15,16).
// When the white pattern is matched, the snake gets yellow for one second, and the next level starts.

// The puzzles are contained in 4x4 5x5, 6x6 or 7x7 squares, at the center of the scene.
// Each puzzle is encoded in the bits of a number (0 : green / 1 : white).

// The function m(p) contains all the puzzles, and tells if the current square (p) is green or white.
m=p=>p%20>7&&p%20<12&&(~~(p/20)*4-12)+(p%20-8);

// Draw / onkeyup:
onkeydown=d=e=>{

// If a key is pressed (e is not null), check if the snake can move down/left/up/right (e.which%4).
// If it doesn t collide with itself, insert the new head position at the beginning of s.
e?s.includes(p=s[0]+[20,-1,-20,1][e.which%4])||s.unshift(p):0;

// Cut the snake after a certain max length (8/13/... depending on the puzzles).
s=s.slice(0,l<6?8:l<12?11:13);

// If all the snake cubes match with all the white squares, game is won (w=1).
// Go to next level and reset snake after 1 second.
w=s.every(m)&&setTimeout("l++;s=[30,10];d()",999);

// Draw the scene (48 elements added in the body b using th string B).
for(B="<button onclick=s=[30,10];d()>Reset<button onclick=s=[30,10];l++;d()>Next</button><p>",i=0;i<200;i++)
b.innerHTML=B+=`<x style=width:22px;height:24px;float:left;background:#${

// Snake squares are colored in tan or green (if the level is won).
// Puzzle squares are colored in black and white.
s.includes(i)?w?"ff0":"da6":

m(i)?"fff;outline:solid+1px":"498"
}${

// Break line after each line of 6 puzzles.
i%20?"":";clear:both"
}>${

// Emoji eyes are added in the first square of the snake.
i-s[0]?m(i):"👀"
}</x>`
}

// Reset snake, start the game
s=[30,10];d(l=0)

'id=b>